const sgMail = require("@sendgrid/mail");
const makeReport = require("./report");
require("dotenv").config();

sgMail.setApiKey(process.env.WP_VULN_SENDGRID_API_KEY);

module.exports = function sendEmail(newItems) {
  const email = {
    to: process.env.WP_VULN_TO_EMAIL,
    from: process.env.WP_VULN_FROM_EMAIL,
    subject: "WordPress Vulnerability Warnings",
    html: makeReport(newItems),
  };

  sgMail.send(email);
};
